#!/usr/bin/with-contenv bashio
# ==============================================================================
# Start nginx for ingress support
# s6-overlay docs: https://github.com/just-containers/s6-overlay
# ==============================================================================

# Create temp directories for nginx
mkdir -p /tmp/nginx/client_body
mkdir -p /tmp/nginx/proxy
mkdir -p /tmp/nginx/fastcgi
mkdir -p /tmp/nginx/uwsgi
mkdir -p /tmp/nginx/scgi

bashio::log.info "Starting nginx for dual-mode ingress support..."
bashio::log.info "Handling both full ingress paths and stripped asset paths"

# Start nginx
exec nginx -c /etc/nginx/nginx.conf